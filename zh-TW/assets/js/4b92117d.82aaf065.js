"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[435],{2705:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>l,contentTitle:()=>s,default:()=>d,frontMatter:()=>i,metadata:()=>c,toc:()=>o});var t=r(4848),a=r(8453);const i={},s="C-style string",c={id:"C/C-style-string",title:"C-style string",description:"String literal/constant",source:"@site/notes/C/C-style-string.md",sourceDirName:"C",slug:"/C/C-style-string",permalink:"/zh-TW/notes/C/C-style-string",draft:!1,unlisted:!1,tags:[],version:"current",frontMatter:{},sidebar:"notes",previous:{title:"C",permalink:"/zh-TW/notes/C"},next:{title:"Computer Architecture",permalink:"/zh-TW/notes/computer-architecture"}},l={},o=[{value:"String literal/constant",id:"string-literalconstant",level:2},{value:"strlen",id:"strlen",level:2},{value:"Declaration and Initialization",id:"declaration-and-initialization",level:2},{value:"1. Declaration and then initialize",id:"1-declaration-and-then-initialize",level:3},{value:"2. Declaration and initilization at once",id:"2-declaration-and-initilization-at-once",level:3},{value:"3. Declaration and initilization at once via string literal",id:"3-declaration-and-initilization-at-once-via-string-literal",level:3},{value:"4. Declaration and inistalization at once via pointer",id:"4-declaration-and-inistalization-at-once-via-pointer",level:3}];function h(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",img:"img",li:"li",ol:"ol",p:"p",pre:"pre",section:"section",strong:"strong",sup:"sup",...(0,a.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.header,{children:(0,t.jsx)(n.h1,{id:"c-style-string",children:"C-style string"})}),"\n",(0,t.jsx)(n.h2,{id:"string-literalconstant",children:"String literal/constant"}),"\n",(0,t.jsx)(n.p,{children:"Literal value like below is a C-style string"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-cpp",children:'"hello world" // 11 characters surrounded by double quotes\n'})}),"\n",(0,t.jsxs)(n.p,{children:["The literal value is deduced to be of ",(0,t.jsx)(n.code,{children:"char[12]"})," type because a string is an array of characters technically. The internal representation of a string has a ",(0,t.jsx)(n.strong,{children:"null character"})," ",(0,t.jsx)(n.code,{children:"'\\0'"})," at the end, whose ASCII code value is 0, so the physical storage required is one more than the number of characters written between the quotes. This means there is no limit to the length of a string. The null character is used to mark the end of the string."]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.img,{src:"https://hackmd.io/_uploads/rkU5T-Mca.png",alt:"array"})}),"\n",(0,t.jsx)(n.h2,{id:"strlen",children:"strlen"}),"\n",(0,t.jsxs)(n.p,{children:["The standard library function ",(0,t.jsx)(n.code,{children:"strlen(s)"})," is declared in the standard header ",(0,t.jsx)(n.code,{children:"<string.h>"}),". It returns the lengh of its character string argument ",(0,t.jsx)(n.code,{children:"s"}),", excluding the null character ",(0,t.jsx)(n.code,{children:"'\\0'"}),"."]}),"\n",(0,t.jsxs)(n.p,{children:["How it was implemented:",(0,t.jsx)(n.sup,{children:(0,t.jsx)(n.a,{href:"#user-content-fn-1",id:"user-content-fnref-1","data-footnote-ref":!0,"aria-describedby":"footnote-label",children:"1"})})]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-cpp",children:"int strlen(char s[]) {\n    int i;\n    while(s[i] != '\\0')\n        ++i;\n    return i;\n}\n"})}),"\n",(0,t.jsx)(n.h2,{id:"declaration-and-initialization",children:"Declaration and Initialization"}),"\n",(0,t.jsx)(n.p,{children:"Only the array of characters that has null character at the end is considered a string. Without the null character at the end, it's just an array of characters."}),"\n",(0,t.jsx)(n.h3,{id:"1-declaration-and-then-initialize",children:"1. Declaration and then initialize"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-cpp",children:"// 1. str is a string\nchar str[6];\nchar_array[0] = 'h';\nchar_array[1] = 'e';\nchar_array[2] = 'l';\nchar_array[3] = 'l';\nchar_array[4] = 'o';\nchar_array[5] = '\\0';\n\n// 2. char_arr is not a string but an array of characters\nchar char_arr[3];\nchar_array[0] = 'a';\nchar_array[1] = 'b';\nchar_array[2] = 'c';\n"})}),"\n",(0,t.jsx)(n.h3,{id:"2-declaration-and-initilization-at-once",children:"2. Declaration and initilization at once"}),"\n",(0,t.jsx)(n.p,{children:"(1) Declare an array of characters with null character at the end and the length of which is 6."}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-cpp",children:"char str[6] = { 'h', 'e', 'l', 'l', 'o', '\\0' }; // (1)\n"})}),"\n",(0,t.jsxs)(n.p,{children:["(2) If the number of items is less than the specified length of array (",(0,t.jsx)(n.code,{children:"5 < 6"}),"), the empty positions(including the last position) will be filled with 0s. And since the last character of a string is null character ",(0,t.jsx)(n.code,{children:"'\\0'"})," which is 0 in ASCII, this way of declaration and initialization is same as (1)."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-cpp",children:"char str[6] = { 'h', 'e', 'l', 'l', 'o' }; // (2)\n"})}),"\n",(0,t.jsxs)(n.p,{children:["(3) If the number of items is larger than the specified length of array (",(0,t.jsx)(n.code,{children:"4 > 3"}),"), the comipler might throw error or show warning."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-cpp",children:"char str[3] = { 'd', 'o', 'g', '\\0' }; // (3)\n"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"warning: excess elements in array initializer [-Wexcess-initializers]\n"})}),"\n",(0,t.jsxs)(n.p,{children:["(4) If the number of elements is not specified inside the squre brackets",(0,t.jsx)(n.code,{children:"[]"}),", the length of the array will be the number of items that are given during initialization."]}),"\n",(0,t.jsxs)(n.p,{children:["For example, it will allocate 6 units of memory to the ",(0,t.jsx)(n.code,{children:"str"})," array since there are 6 items in the curly brackets. Note that the length of array is 6 while the length of string will be 5 since null character is not counted."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-cpp",children:"char str[] = { 'h', 'e', 'l', 'l', 'o', '\\0' }; // (4)\n"})}),"\n",(0,t.jsx)(n.h3,{id:"3-declaration-and-initilization-at-once-via-string-literal",children:"3. Declaration and initilization at once via string literal"}),"\n",(0,t.jsx)(n.p,{children:"(1) The specified length of the array should be the number of charaters of the string plus 1."}),"\n",(0,t.jsx)(n.p,{children:"For example, there are 5 characters in the double quotes, but it requires 6 units of memory since string literals implicitly have a null charater at the end."}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-cpp",children:'char str[6] = "hello"; // (1)\n'})}),"\n",(0,t.jsx)(n.p,{children:"(2) The length of the array can be left empty so the compiler will be responsible for deciding the length."}),"\n",(0,t.jsxs)(n.p,{children:["As you can see in the example, the compiler decides that the size of ",(0,t.jsx)(n.code,{children:"str"})," array is 6 bytes, even though there are only 5 characters in the double quotes."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-cpp",children:'char str[] = "hello"; // (2)\nprintf("The size of str is %lu bytes\\n", sizeof(str));\n'})}),"\n",(0,t.jsx)(n.p,{children:"Result:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"The size of str is 6 bytes.\n"})}),"\n",(0,t.jsx)(n.p,{children:"(3) Without extra one position for the null character, it can only be considered as a character array. Used it as a string might cause unexpcted results."}),"\n",(0,t.jsxs)(n.p,{children:["For example, the character array ",(0,t.jsx)(n.code,{children:"char_arr"})," has length of 3 and stores 3 characters \u2013",(0,t.jsx)(n.code,{children:"'d', 'o', 'g'"}),". There is no extra room at the end of ",(0,t.jsx)(n.code,{children:"char_arr"})," for the null character. If we use ",(0,t.jsx)(n.code,{children:"char_arr"})," as a string and passed it to the ",(0,t.jsx)(n.code,{children:"strlen"})," function to get the length, the result might not be 3, but rather a random number depends on when it meets the null character in the sequence of memory that the array is allocated to. In the below example, ",(0,t.jsx)(n.code,{children:"strlen"})," returns 4."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-cpp",children:'char char_arr[3] = "dog"; (3)\nprintf("strlen of char_arr = %lu", strlen(char_arr));\n'})}),"\n",(0,t.jsx)(n.p,{children:"Result:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:"strlen of char_arr = 4\n"})}),"\n",(0,t.jsx)(n.h3,{id:"4-declaration-and-inistalization-at-once-via-pointer",children:"4. Declaration and inistalization at once via pointer"}),"\n",(0,t.jsx)(n.p,{children:"The name of character array stores the address of first character in the array. A pointer to the character can serve the same purpose and thus we can declare a string using a pointer to the character."}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-cpp",children:'char* str = "hello";\n'})}),"\n",(0,t.jsxs)(n.p,{children:["However, using pointer loses the type and the dimension information, which is know as ",(0,t.jsx)(n.strong,{children:"array decay"}),(0,t.jsx)(n.sup,{children:(0,t.jsx)(n.a,{href:"#user-content-fn-2",id:"user-content-fnref-2","data-footnote-ref":!0,"aria-describedby":"footnote-label",children:"2"})})," in C. Most of the time, character array and pointer to character can be used interchangably, but there are some differeces between array name and the pointer that one should be aware of."]}),"\n",(0,t.jsx)(n.p,{children:"In short, array name cannot be changed unlike pointer can be assigned with new value."}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-cpp",children:'char* str_ptr = "hello"; // str_ptr now points to h\nstr_ptr = str_ptr + 1; // increment is allowed\nprintf("The 1st-indexed element is = %c", *str); // prints e\n'})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-cpp",children:'char char_arr[] = "hello";\nchar_arr = char_arr + 1; // increment is not allowed\n\nchar char_arr2[] = "world";\nchar_arr = str_ptr; // re-assignment is not allowed\nchar_arr = char_arr2; // re-assignment is not allowed\n'})}),"\n","\n",(0,t.jsxs)(n.section,{"data-footnotes":!0,className:"footnotes",children:[(0,t.jsx)(n.h2,{className:"sr-only",id:"footnote-label",children:"Footnotes"}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{id:"user-content-fn-1",children:["\n",(0,t.jsxs)(n.p,{children:["K&R The C programming language 2nd edition ",(0,t.jsx)(n.a,{href:"#user-content-fnref-1","data-footnote-backref":"","aria-label":"Back to reference 1",className:"data-footnote-backref",children:"\u21a9"})]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{id:"user-content-fn-2",children:["\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.a,{href:"https://stackoverflow.com/a/1641963/13715554",children:"https://stackoverflow.com/a/1641963/13715554"})," ",(0,t.jsx)(n.a,{href:"#user-content-fnref-2","data-footnote-backref":"","aria-label":"Back to reference 2",className:"data-footnote-backref",children:"\u21a9"})]}),"\n"]}),"\n"]}),"\n"]})]})}function d(e={}){const{wrapper:n}={...(0,a.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(h,{...e})}):h(e)}},8453:(e,n,r)=>{r.d(n,{R:()=>s,x:()=>c});var t=r(6540);const a={},i=t.createContext(a);function s(e){const n=t.useContext(i);return t.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:s(e.components),t.createElement(i.Provider,{value:n},e.children)}}}]);